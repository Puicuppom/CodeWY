<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå Excel ‚Üí Code + SaleDB + ‡πÅ‡∏ï‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô + Discount + UseCode_True + Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0f172a; --bg2:#0b1226; --card:#0f1b39; --muted:#9fb0d8; --fg:#e6eeff; --accent:#60a5fa;
      --ok:#22c55e; --warn:#f59e0b; --err:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:linear-gradient(180deg,var(--bg),var(--bg2));color:var(--fg);font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial}
    .wrap{max-width:1100px;margin:28px auto;padding:0 16px}
    .hero{
      background: radial-gradient(1200px 300px at 10% -10%, #1e3a8a55, transparent),
                  radial-gradient(1200px 300px at 90% -10%, #0ea5e955, transparent);
      border:1px solid #1e293b; border-radius:18px; padding:22px 20px; box-shadow:0 10px 40px #0006;
    }
    h1{margin:0 0 6px 0;font-size:22px;font-weight:800;letter-spacing:.2px}
    .sub{margin:6px 0 14px 0;color:var(--muted);font-size:14px;line-height:1.6}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .field{background:rgba(255,255,255,.03);border:1px solid #20304d;border-radius:14px;padding:14px}
    .label{font-size:12px;color:#c7d2fe;margin-bottom:8px;font-weight:700;letter-spacing:.4px;text-transform:uppercase}
    input[type="file"]{width:100%;padding:12px;border:1px dashed #405a8a;border-radius:10px;background:#0a142b;color:#cbd5e1}
    .actions{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-top:12px}
    .btn{border:0;border-radius:12px;padding:12px 16px;background:linear-gradient(180deg,#60a5fa,#3b82f6);color:#fff;font-weight:800;cursor:pointer;box-shadow:0 8px 24px #0007}
    .badge{display:inline-flex;align-items:center;gap:8px;background:#122145;border:1px solid #243a6b;color:#c7d2fe;padding:8px 10px;border-radius:999px;font-size:12px}
    .summary{margin-top:8px;color:#cbd5e1;font-size:13px}
    .log{margin-top:12px;background:#070d1e;color:#cfe3ff;padding:12px;border-radius:12px;max-height:280px;overflow:auto;font-size:12px;border:1px solid #1a2750}
    .k{color:#9ca3af}
    .ok{color:var(--ok)} .warn{color:var(--warn)} .err{color:var(--err)}
    .footer{margin-top:14px;color:#9fb0d8;font-size:12px}
    .pill{display:inline-block;background:#0b1b37;border:1px solid #1b2f5a;border-radius:999px;padding:2px 8px;color:#9fb0d8}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <h1>‡∏£‡∏ß‡∏°‡πÑ‡∏ü‡∏•‡πå Excel ‚Üí Code + SaleDB(‡πÅ‡∏ï‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô) + <span class="pill">Discount</span> + <span class="pill">UseCode_True</span> + <span class="pill">Dashboard</span></h1>
      <div class="sub">
        ‡πÅ‡∏ï‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠ I&gt;1: <code>base = (J + G) / I</code> ‚Ä¢ ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å: <code>J = base ‚àí G</code> (‡∏Ñ‡∏á G/H) ‚Ä¢ ‡πÅ‡∏ñ‡∏ß‡∏ñ‡∏±‡∏î‡πÑ‡∏õ: <code>J = base</code> ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á <b>G = 0</b>, H ‡∏ß‡πà‡∏≤‡∏á ‚Üí ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡∏•‡∏á‡πÅ‡∏ó‡πá‡∏ö <b>Discount - 0</b> ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥<br/>
        ‡∏à‡∏∞‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ <b>Total:</b> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
      </div>

      <div class="grid">
        <div class="field">
          <div class="label">‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Excel ‡πÇ‡∏Ñ‡πâ‡∏î (‡∏≠‡πà‡∏≤‡∏ô A2:A ‚Üí Code, Lot)</div>
          <input id="dir" type="file" webkitdirectory directory multiple accept=".xls,.xlsx" />
          <div id="sumCode" class="summary">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
        </div>
        <div class="field">
          <div class="label">‡πÑ‡∏ü‡∏•‡πå SaleDB (‡∏´‡∏±‡∏ß A4:O4 ‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• A5:O)</div>
          <input id="sale" type="file" accept=".xls,.xlsx" />
          <div id="sumSale" class="summary">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå SaleDB</div>
        </div>
      </div>

      <div class="actions">
        <button id="runXlsx" class="btn">üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Excel: ‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡πÅ‡∏ó‡πá‡∏ö</button>
        <span id="libStatus" class="badge">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î XLSX‚Ä¶</span>
      </div>

      <pre id="log" class="log" hidden></pre>
      <div class="footer">‡∏´‡∏≤‡∏Å‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢ Chrome/Edge ‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Pop-up)</div>
    </div>
  </div>

  <!-- ‡πÇ‡∏´‡∏•‡∏î SheetJS: local ‚Üí CDN -->
  <script>
  (function loadXLSX(){
    const el = document.getElementById('libStatus');
    function set(msg, ok){ el.textContent = msg; el.style.color = ok ? '#a7f3d0' : '#fecaca'; }
    function inject(src, onload, onerror){ const s=document.createElement('script'); s.src=src; s.onload=onload; s.onerror=onerror; document.head.appendChild(s); }
    inject('./xlsx.full.min.js', ()=>set('‡∏û‡∏ö XLSX (local) ‚úî', true),
      ()=>inject('https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js',
        ()=>set('‡πÇ‡∏´‡∏•‡∏î XLSX ‡∏à‡∏≤‡∏Å CDN ‚úî', true),
        ()=>set('‚ùå ‡πÇ‡∏´‡∏•‡∏î XLSX ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', false)
      )
    );
  })();
  </script>

  <script>
  /* ---------- Elements & State ---------- */
  const dirInput  = document.getElementById('dir');
  const saleInput = document.getElementById('sale');
  const runBtn    = document.getElementById('runXlsx');
  const sumCode   = document.getElementById('sumCode');
  const sumSale   = document.getElementById('sumSale');
  const logEl     = document.getElementById('log');

  let pickedFiles = [];
  let saleFile    = null;

  /* ---------- Helpers ---------- */
  function log(msg,type='i'){
    logEl.hidden=false;
    const pfx = type==='e'?'[ERR] ':type==='w'?'[WARN] ':'[INFO] ';
    logEl.textContent += pfx + msg + '\n';
    logEl.scrollTop = logEl.scrollHeight;
  }
  function basename(n){ const i=n.lastIndexOf('.'); return i>0?n.slice(0,i):n; }
  function sheetNameSafe(n){ return (String(n).replace(/[:\\/?*\[\]]/g,' ').trim()||'Sheet').slice(0,31); }
  function cleanCode(v){ return v==null?'':String(v).replace(/['"]/g,'').trim(); }
  function toNum(v){ const n = Number(String(v).replace(/,/g,'').trim()); return isNaN(n)?0:n; }

  async function readFirstSheet(file){
    return new Promise((resolve,reject)=>{
      const fr=new FileReader();
      fr.onload=()=>{
        try{
          const data = new Uint8Array(fr.result);
          const wb   = XLSX.read(data,{type:'array',cellDates:false});
          if(!wb.SheetNames.length){ resolve({sheet:null}); return; }
          resolve({sheet: wb.Sheets[wb.SheetNames[0]]});
        }catch(e){ reject(e); }
      };
      fr.onerror=()=>reject(fr.error);
      fr.readAsArrayBuffer(file);
    });
  }

  async function readCodesFromFile(file){
    const {sheet}=await readFirstSheet(file);
    if(!sheet) return [];
    const rows = XLSX.utils.sheet_to_json(sheet,{header:1,raw:true,defval:''});
    const out=[];
    for(let r=1;r<rows.length;r++){
      const val = rows[r]?.[0] ?? '';
      const code = cleanCode(val);
      if(code) out.push(code);
    }
    return out;
  }

  async function readSaleDB(file){
    const {sheet}=await readFirstSheet(file);
    if(!sheet) return {header:[], rows:[]};
    const rows   = XLSX.utils.sheet_to_json(sheet,{header:1,raw:true,defval:''});
    const header = (rows[3]||[]).slice(0,15);        // A..O
    const data   = [];
    for(let r=4;r<rows.length;r++){
      const row = (rows[r]||[]).slice(0,15);
      // ‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°/ Total:
      if(row.join('').toLowerCase().includes('total:')) continue;
      if(row.some(v=>String(v).trim()!=='')) data.push(row);
    }
    return {header, rows:data};
  }

  /* --- ‡πÅ‡∏ï‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: base=(J+G)/I | ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å J=base-G (‡∏Ñ‡∏á G/H), ‡πÅ‡∏ñ‡∏ß‡∏≠‡∏∑‡πà‡∏ô J=base ‡πÅ‡∏•‡∏∞ G=0/H='' --- */
  function expandSaleRows(rows){
    const IDX_G=6, IDX_H=7, IDX_I=8, IDX_J=9;
    const out=[];
    let expanded=0, added=0;

    for(const row of rows){
      const qty = Math.max(1, Math.floor(toNum(row[IDX_I])) || 1);
      const g   = toNum(row[IDX_G]);
      const j   = toNum(row[IDX_J]);

      if(qty===1){
        const r = row.slice();
        r[IDX_I]=1;
        out.push(r);
        continue;
      }

      const base = (j + g) / qty;
      for(let k=0;k<qty;k++){
        const r = row.slice();
        r[IDX_I] = 1;
        if(k===0){
          r[IDX_J] = base - g; // keep G/H
        }else{
          r[IDX_J] = base;
          r[IDX_G] = 0;        // ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏Å‡∏•‡∏∏‡πà‡∏° Discount - 0
          r[IDX_H] = '';       // ‡πÑ‡∏°‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Code
        }
        out.push(r);
      }
      expanded++; added += (qty-1);
    }
    log(`(‡πÅ‡∏ï‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô) ‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å: ${expanded} | ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß: ${added}`);
    return out;
  }

  /* ---------- UI events ---------- */
  dirInput.addEventListener('change', e=>{
    pickedFiles = Array.from(e.target.files||[]);
    const xls   = pickedFiles.filter(f=>/\.(xlsx?|XLSX?|Xls|XLS)$/.test(f.name)).length;
    sumCode.innerHTML = `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <b>${pickedFiles.length.toLocaleString()}</b> ‡πÑ‡∏ü‡∏•‡πå ‚Ä¢ Excel <b>${xls}</b> ‡πÑ‡∏ü‡∏•‡πå`;
    log(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Code: ${pickedFiles.length} ‡πÑ‡∏ü‡∏•‡πå`);
  });

  saleInput.addEventListener('change', e=>{
    saleFile = e.target.files?.[0]||null;
    sumSale.innerHTML = saleFile ? `<b>${saleFile.name}</b>` : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå SaleDB';
    log(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å SaleDB: ${saleFile?saleFile.name:'‚Äî'}`);
  });

  /* ---------- Main: build & download ---------- */
  runBtn.addEventListener('click', async ()=>{
    if(!window.XLSX){ alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ XLSX'); return; }
    const codeFiles = pickedFiles.filter(f=>/\.(xlsx?|XLSX?|Xls|XLS)$/.test(f.name));
    if(!codeFiles.length){ alert('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡∏Å‡πà‡∏≠‡∏ô'); return; }
    if(!saleFile){ alert('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå SaleDB ‡∏Å‡πà‡∏≠‡∏ô'); return; }

    logEl.hidden=false; logEl.textContent='';
    log('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‚Ä¶');

    /* 1) ‡∏£‡∏ß‡∏° Code */
    const codeAoA = [['Code','Lot']];
    for(const f of codeFiles){
      try{
        const lot   = basename(f.name);
        const codes = await readCodesFromFile(f);
        codes.forEach(c => codeAoA.push([c,lot]));
        log(`(Code) ${f.name} ‚Üí ${codes.length} ‡πÅ‡∏ñ‡∏ß`);
      }catch(e){ log(`‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${f.name} ‚Üí ${e.message||e}`,'e'); }
    }
    if(codeAoA.length===1){ alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Code ‡πÉ‡∏ô A2:A ‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå'); return; }

    /* 2) SaleDB + ‡πÅ‡∏ï‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô */
    let saleHeader=[], saleRows=[];
    try{
      const {header, rows} = await readSaleDB(saleFile);
      saleHeader = header;
      saleRows   = expandSaleRows(rows);
      log(`(SaleDB) ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ï‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${saleRows.length} ‡πÅ‡∏ñ‡∏ß`);
    }catch(e){ log(`‡∏≠‡πà‡∏≤‡∏ô SaleDB ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${e.message||e}`,'e'); alert('‡∏≠‡πà‡∏≤‡∏ô SaleDB ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); return; }

    /* 3) ‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏° ‚Üí Discount / UseCode_True (‡∏ï‡∏≤‡∏° G) */
    const IDX_G=6, IDX_H=7;
    const codeSet = new Set(codeAoA.slice(1).map(r=>String(r[0]).trim()));

    const mapDiscount = new Map(); // H not-in Code
    const mapTrue     = new Map(); // H in Code
    for(const row of saleRows){
      const g = String(row[IDX_G]??'').trim();
      const h = String(row[IDX_H]??'').trim();
      if(!g && g!=='0') continue;   // ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ G (‡∏£‡∏ß‡∏° 0)
      const inCode = (h && codeSet.has(h));
      const bucket = inCode ? mapTrue : mapDiscount;
      if(!bucket.has(g)) bucket.set(g, []);
      bucket.get(g).push(row);
    }

    const sortAsc=(a,b)=>{ const na=Number(a), nb=Number(b); if(!isNaN(na)&&!isNaN(nb)) return na-nb; return String(a).localeCompare(String(b)); };
    const discEntries = Array.from(mapDiscount.entries()).sort((a,b)=>sortAsc(a[0],b[0]));
    const trueEntries = Array.from(mapTrue.entries()).sort((a,b)=>sortAsc(a[0],b[0]));

    /* 4) ‡∏™‡∏£‡πâ‡∏≤‡∏á Workbook */
    const wb = XLSX.utils.book_new();

    // Code
    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(codeAoA), 'Code');

    // SaleDB (‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ï‡∏Å)
    const saleAoA = saleHeader.length ? [saleHeader, ...saleRows] : [...saleRows];
    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(saleAoA), 'SaleDB');

    // Discount - {G} (H not-in Code)
    for(const [g, rows] of discEntries){
      const aoa = saleHeader.length ? [saleHeader, ...rows] : [...rows];
      XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(aoa), sheetNameSafe(`Discount - ${g}`));
    }

    // UseCode_True - {G} (H in Code)
    for(const [g, rows] of trueEntries){
      const aoa = saleHeader.length ? [saleHeader, ...rows] : [...rows];
      XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(aoa), sheetNameSafe(`UseCode_True - ${g}`));
    }

    // Dashboard: ‡∏£‡∏ß‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏∏‡∏Å‡πÅ‡∏ó‡πá‡∏ö‡∏¢‡πà‡∏≠‡∏¢
    const dash = [["Type","G","Rows"]];
    for(const [g, rows] of discEntries) dash.push(["Discount", g, rows.length]);
    for(const [g, rows] of trueEntries) dash.push(["UseCode_True", g, rows.length]);
    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(dash), 'Dashboard');

    /* 5) ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå (‡∏û‡∏£‡πâ‡∏≠‡∏° fallback) */
    const outName = `Combined_${new Date().toISOString().slice(0,19).replace(/[:T]/g,'-')}.xlsx`;
    try{
      XLSX.writeFile(wb, outName);
    }catch(e){
      log(`writeFile ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‚Üí fallback blob`, 'w');
      try{
        const wbout = XLSX.write(wb, {bookType:'xlsx', type:'array'});
        const blob  = new Blob([wbout], {type:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'});
        const url   = URL.createObjectURL(blob);
        const a     = document.createElement('a');
        a.href = url; a.download = outName; document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      }catch(ee){
        log(`fallback blob ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${ee.message||ee}`, 'e');
        alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ');
        return;
      }
    }

    // ‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤
    const discTotal = discEntries.reduce((s,[,rows])=>s+rows.length,0);
    const trueTotal = trueEntries.reduce((s,[,rows])=>s+rows.length,0);
    sumCode.innerHTML = `Code ‡∏£‡∏ß‡∏° <b>${(codeAoA.length-1).toLocaleString()}</b> ‡πÅ‡∏ñ‡∏ß ‚Ä¢ Discount <b>${discTotal.toLocaleString()}</b> ‚Ä¢ UseCode_True <b>${trueTotal.toLocaleString()}</b>`;
    log(`‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢: ${outName}`);
  });
  </script>
</body>
</html>
